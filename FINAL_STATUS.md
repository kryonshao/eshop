# ğŸ‰ å•†å®¶åå°è®¾ç½®å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ç”¨æˆ·è§’è‰²ç³»ç»Ÿ âœ…
- âœ… åˆ›å»º `profiles` è¡¨
- âœ… è®¾ç½® `yufeng@altes.com` ä¸º admin è§’è‰²
- âœ… ä¿®å¤ RLS ç­–ç•¥ï¼ˆè§£å†³ 500 é”™è¯¯ï¼‰
- âœ… é‚®ç®±å·²ç¡®è®¤

### 2. æ•°æ®åº“è¡¨ âœ…
å·²åˆ›å»ºæ‰€æœ‰å¿…éœ€çš„è¡¨ï¼š
- âœ… `profiles` - ç”¨æˆ·è§’è‰²
- âœ… `products` - å•†å“
- âœ… `product_translations` - å•†å“ç¿»è¯‘ï¼ˆå¤šè¯­è¨€ï¼‰
- âœ… `category_translations` - åˆ†ç±»ç¿»è¯‘
- âœ… `orders` - è®¢å•
- âœ… `order_items` - è®¢å•å•†å“æ˜ç»†
- âœ… `order_tracking` - è®¢å•è·Ÿè¸ª
- âœ… `cart_items` - è´­ç‰©è½¦
- âœ… `wishlist` - æ”¶è—å¤¹
- âœ… `coupons` - ä¼˜æƒ åˆ¸
- âœ… `coupon_redemptions` - ä¼˜æƒ åˆ¸ä½¿ç”¨è®°å½•
- âœ… `payments` - æ”¯ä»˜è®°å½•
- âœ… `refunds` - é€€æ¬¾è®°å½•
- âœ… `warehouses` - ä»“åº“
- âœ… `skus` - å•†å“è§„æ ¼
- âœ… `inventory` - åº“å­˜
- âœ… `stock_movements` - åº“å­˜å˜åŠ¨
- âœ… `shipping_providers` - ç‰©æµå•†
- âœ… `shipments` - å‘è´§è®°å½•
- âœ… `tracking_events` - ç‰©æµè·Ÿè¸ª
- âœ… `reviews` - ç”¨æˆ·è¯„ä»·
- âœ… `review_replies` - å•†å®¶å›å¤
- âœ… `nowpayments_webhook_events` - æ”¯ä»˜å›è°ƒ
- âœ… `system_events` - ç³»ç»Ÿäº‹ä»¶

### 3. æƒé™é…ç½® âœ…
- âœ… æ‰€æœ‰è¡¨çš„ RLS ç­–ç•¥å·²é…ç½®
- âœ… Admin å’Œ Merchant æ‹¥æœ‰ç®¡ç†æƒé™
- âœ… Customer æ‹¥æœ‰åŸºæœ¬è´­ç‰©æƒé™
- âœ… åŒ¿åç”¨æˆ·å¯ä»¥æµè§ˆå•†å“

### 4. å•†å®¶åå°åŠŸèƒ½ âœ…
- âœ… æ¦‚è§ˆé¡µé¢ - è®¢å•ç»Ÿè®¡ã€è¯„ä»·ç»Ÿè®¡
- âœ… å•†å“ç®¡ç† - æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤å•†å“
- âœ… åº“å­˜ç®¡ç† - SKU ç®¡ç†ã€åº“å­˜è°ƒæ•´ã€åº“å­˜é¢„è­¦
- âœ… è®¢å•ç®¡ç† - æŸ¥çœ‹è®¢å•ã€æ›´æ–°è®¢å•çŠ¶æ€
- âœ… è¯„ä»·ç®¡ç† - å®¡æ ¸è¯„ä»·ã€å›å¤è¯„ä»·
- âœ… ä¼˜æƒ åˆ¸ç®¡ç† - åˆ›å»ºã€ç¼–è¾‘ä¼˜æƒ åˆ¸

### 5. å›½é™…åŒ–æ”¯æŒ âœ…
- âœ… æ”¯æŒ 7 ç§è¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±æ–‡ã€è¥¿ç­ç‰™è¯­ã€æ³•è¯­ã€å¾·è¯­ã€æ—¥è¯­ã€éŸ©è¯­ï¼‰
- âœ… å•†å“å¤šè¯­è¨€ç¿»è¯‘
- âœ… åˆ†ç±»å¤šè¯­è¨€ç¿»è¯‘

### 6. ç‰©æµé…é€ç³»ç»Ÿ âœ…
- âœ… ç‰©æµå•†ç®¡ç†
- âœ… å‘è´§ç®¡ç†
- âœ… ç‰©æµè·Ÿè¸ª
- âœ… è¿è´¹è®¡ç®—

### 7. ä»£ç ä¿®å¤ âœ…
- âœ… ä¿®å¤ `useUserRole` hook çš„ 500 é”™è¯¯
- âœ… ä¿®å¤ `ProductCard` ç»„ä»¶çš„åµŒå¥— Link è­¦å‘Š
- âœ… ä¿®å¤æ‰€æœ‰ 404 é”™è¯¯

## ğŸ“Š ç³»ç»Ÿæ¶æ„

```
å‰ç«¯ (React + Vite)
  â†“ http://localhost:8080/
  â†“
Supabase (è¿œç¨‹)
  â†“ mqpicboeltjzhfnvtkeh.supabase.co
  â†“
PostgreSQL æ•°æ®åº“
  â”œâ”€â”€ ç”¨æˆ·ç³»ç»Ÿ (profiles, auth.users)
  â”œâ”€â”€ å•†å“ç³»ç»Ÿ (products, product_translations, skus)
  â”œâ”€â”€ è®¢å•ç³»ç»Ÿ (orders, order_items, order_tracking)
  â”œâ”€â”€ è´­ç‰©è½¦ (cart_items, wishlist)
  â”œâ”€â”€ æ”¯ä»˜ç³»ç»Ÿ (payments, refunds, nowpayments_webhook_events)
  â”œâ”€â”€ åº“å­˜ç³»ç»Ÿ (warehouses, inventory, stock_movements)
  â”œâ”€â”€ ç‰©æµç³»ç»Ÿ (shipping_providers, shipments, tracking_events)
  â”œâ”€â”€ è¯„ä»·ç³»ç»Ÿ (reviews, review_replies)
  â””â”€â”€ ä¼˜æƒ åˆ¸ç³»ç»Ÿ (coupons, coupon_redemptions)
```

## ğŸ”‘ ç®¡ç†å‘˜è´¦å·

- **é‚®ç®±**: `yufeng@altes.com`
- **è§’è‰²**: `admin`
- **æƒé™**: æ‹¥æœ‰æ‰€æœ‰å•†å®¶åå°æƒé™

## ğŸš€ è®¿é—®åœ°å€

- **å‰ç«¯**: http://localhost:8080/
- **å•†å®¶åå°**: http://localhost:8080/merchant
- **Supabase Dashboard**: https://supabase.com/dashboard/project/mqpicboeltjzhfnvtkeh

## ğŸ“‹ å·²æ‰§è¡Œçš„ SQL è„šæœ¬

1. âœ… `SIMPLE_DATABASE_SETUP.sql` - åŸºç¡€æ•°æ®åº“è®¾ç½®
2. âœ… `ONE_CLICK_FIX.sql` - ç®¡ç†å‘˜è´¦å·è®¾ç½®
3. âœ… `EMERGENCY_FIX.sql` - RLS ç­–ç•¥ä¿®å¤
4. âœ… `CREATE_MISSING_TABLES.sql` - åˆ›å»ºç¼ºå¤±çš„è¡¨
5. âœ… `FIX_ALL_MERCHANT_PERMISSIONS.sql` - ä¿®å¤æ‰€æœ‰æƒé™
6. âœ… `CREATE_I18N_TABLES.sql` - åˆ›å»ºå›½é™…åŒ–è¡¨

## âš ï¸ å·²çŸ¥é—®é¢˜ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰

### React Router è­¦å‘Š
```
âš ï¸ React Router Future Flag Warning: v7_startTransition
âš ï¸ React Router Future Flag Warning: v7_relativeSplatPath
```
è¿™äº›æ˜¯ React Router ç‰ˆæœ¬å‡çº§æç¤ºï¼Œä¸å½±å“åŠŸèƒ½ã€‚

## ğŸ¯ åŠŸèƒ½æµ‹è¯•æ¸…å•

### å•†å®¶åå°
- [x] ç™»å½•å•†å®¶åå°
- [x] æŸ¥çœ‹æ¦‚è§ˆé¡µé¢
- [x] æ·»åŠ å•†å“
- [x] ç¼–è¾‘å•†å“
- [x] åˆ é™¤å•†å“
- [x] ç®¡ç†åº“å­˜
- [x] æŸ¥çœ‹è®¢å•
- [x] ç®¡ç†è¯„ä»·
- [x] åˆ›å»ºä¼˜æƒ åˆ¸

### å‰ç«¯åŠŸèƒ½
- [x] æµè§ˆå•†å“
- [x] æ·»åŠ åˆ°è´­ç‰©è½¦
- [x] æ·»åŠ åˆ°æ”¶è—å¤¹
- [x] å¤šè¯­è¨€åˆ‡æ¢
- [x] ç”¨æˆ·æ³¨å†Œç™»å½•

## ğŸ“ ç»´æŠ¤å»ºè®®

### å®šæœŸå¤‡ä»½
å»ºè®®å®šæœŸå¤‡ä»½ Supabase æ•°æ®åº“ï¼š
- Dashboard â†’ Database â†’ Backups

### ç›‘æ§æ—¥å¿—
å®šæœŸæ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ï¼š
- Dashboard â†’ Logs â†’ Postgres Logs
- Dashboard â†’ Logs â†’ API Logs

### æ€§èƒ½ä¼˜åŒ–
- å®šæœŸæ¸…ç†æ—§çš„ `system_events` è®°å½•
- ç›‘æ§ `stock_movements` è¡¨å¤§å°
- ä¼˜åŒ–æ…¢æŸ¥è¯¢

## ğŸ†˜ æ•…éšœæ’é™¤

### å¦‚æœå•†å®¶åå°æ— æ³•è®¿é—®
1. æ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼š
   ```sql
   SELECT email, user_role FROM public.profiles WHERE email = 'yufeng@altes.com';
   ```
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶é‡æ–°ç™»å½•
3. æ£€æŸ¥ F12 æ§åˆ¶å°é”™è¯¯

### å¦‚æœå•†å“æ— æ³•æ·»åŠ 
1. æ£€æŸ¥æƒé™ï¼š
   ```sql
   SELECT grantee, privilege_type 
   FROM information_schema.role_table_grants
   WHERE table_name = 'products' AND grantee = 'authenticated';
   ```
2. æ£€æŸ¥ RLS ç­–ç•¥ï¼š
   ```sql
   SELECT policyname, cmd FROM pg_policies 
   WHERE tablename = 'products';
   ```

### å¦‚æœå‡ºç° 404 é”™è¯¯
1. æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨ï¼š
   ```sql
   SELECT table_name FROM information_schema.tables 
   WHERE table_schema = 'public' ORDER BY table_name;
   ```
2. æ£€æŸ¥ RLS æ˜¯å¦å¯ç”¨ï¼š
   ```sql
   SELECT tablename, rowsecurity FROM pg_tables 
   WHERE schemaname = 'public';
   ```

## ğŸ‰ æ€»ç»“

æ‚¨çš„è·¨å¢ƒç”µå•†å¹³å°å·²ç»å®Œå…¨è®¾ç½®å®Œæˆï¼

- âœ… æ•°æ®åº“ï¼š26+ ä¸ªè¡¨ï¼Œå®Œæ•´çš„ RLS ç­–ç•¥
- âœ… å•†å®¶åå°ï¼š6 å¤§åŠŸèƒ½æ¨¡å—
- âœ… å›½é™…åŒ–ï¼šæ”¯æŒ 7 ç§è¯­è¨€
- âœ… ç‰©æµç³»ç»Ÿï¼šå®Œæ•´çš„ç‰©æµé…é€åŠŸèƒ½
- âœ… æ”¯ä»˜ç³»ç»Ÿï¼šåŠ å¯†è´§å¸æ”¯ä»˜é›†æˆ
- âœ… åº“å­˜ç³»ç»Ÿï¼šå¤šä»“åº“ã€å¤š SKU ç®¡ç†

ç°åœ¨æ‚¨å¯ä»¥ï¼š
1. æ·»åŠ å•†å“å’Œ SKU
2. ç®¡ç†åº“å­˜
3. å¤„ç†è®¢å•
4. ç®¡ç†è¯„ä»·
5. åˆ›å»ºä¼˜æƒ åˆ¸
6. å¤„ç†ç‰©æµé…é€

ç¥æ‚¨ç”Ÿæ„å…´éš†ï¼ğŸš€
