# 库存管理使用指南

## 如何访问库存管理

1. **登录商家账号**
   - 使用具有商家（merchant）或管理员（admin）权限的账号登录

2. **进入商家后台**
   - 访问商家管理后台页面
   - 点击顶部导航栏的"库存"标签

## 库存管理功能

### 1. 库存列表（主界面）

**功能说明：**
- 查看所有 SKU 的库存情况
- 按仓库筛选库存
- 搜索特定 SKU 或商品

**显示信息：**
- SKU 代码：商品的唯一标识码
- 商品名称：商品的名称
- 仓库：库存所在的仓库
- 可用库存：可以销售的库存数量
- 预留库存：已被订单占用但未发货的库存
- 总库存：可用库存 + 预留库存
- 预警状态：显示是否低于预警阈值

**操作：**
- 点击"调整库存"按钮可以增加或减少库存

### 2. 调整库存

**步骤：**

1. **选择 SKU**
   - 在库存列表中找到要调整的 SKU
   - 点击"调整库存"按钮

2. **选择仓库**
   - 从下拉菜单选择要调整库存的仓库

3. **查看当前库存**
   - 系统会显示该 SKU 在选定仓库的当前库存情况
   - 包括可用库存、预留库存和总库存

4. **选择调整类型**
   - **增加库存**：用于补货、入库等场景
   - **减少库存**：用于盘点调整、损坏报废等场景

5. **输入调整数量**
   - 输入要增加或减少的数量
   - 系统会实时显示调整后的库存数量

6. **填写调整原因**（必填）
   - 例如：
     - "补货入库"
     - "盘点调整"
     - "损坏报废"
     - "退货入库"
     - "样品出库"

7. **确认调整**
   - 检查调整后的库存数量是否正确
   - 点击"确认调整"按钮

### 3. 库存预警

**功能说明：**
- 自动监控低库存商品
- 当库存低于预警阈值时会显示警告

**查看方式：**
- 切换到"库存预警"标签
- 查看所有低库存的 SKU
- 可以直接从预警列表调整库存

### 4. 变动历史

**功能说明：**
- 记录所有库存变动
- 包括调整时间、操作人、调整数量、原因等

**查看方式：**
- 切换到"变动历史"标签
- 可以按时间、SKU、仓库等条件筛选

## 常见使用场景

### 场景 1：新商品入库

1. 进入库存管理
2. 找到对应的 SKU（如果是新 SKU，需要先在 SKU 管理中创建）
3. 点击"调整库存"
4. 选择"增加库存"
5. 输入入库数量
6. 填写原因："新品入库"
7. 确认调整

### 场景 2：盘点调整

1. 进入库存管理
2. 找到需要调整的 SKU
3. 点击"调整库存"
4. 根据实际盘点结果选择"增加"或"减少"
5. 输入差异数量
6. 填写原因："盘点调整 - 实际库存与系统不符"
7. 确认调整

### 场景 3：商品损坏报废

1. 进入库存管理
2. 找到损坏商品的 SKU
3. 点击"调整库存"
4. 选择"减少库存"
5. 输入报废数量
6. 填写原因："商品损坏报废"
7. 确认调整

### 场景 4：退货入库

1. 进入库存管理
2. 找到退货商品的 SKU
3. 点击"调整库存"
4. 选择"增加库存"
5. 输入退货数量
6. 填写原因："客户退货入库 - 订单号 XXX"
7. 确认调整

## SKU 管理

### 什么是 SKU？

SKU（Stock Keeping Unit）是库存量单位，每个 SKU 代表一个具体的商品变体。

**示例：**
- 商品：T恤
- SKU-1：T恤 - 红色 - S码
- SKU-2：T恤 - 红色 - M码
- SKU-3：T恤 - 蓝色 - S码

### 如何创建 SKU？

1. 进入商家后台
2. 切换到"商品"标签
3. 选择要管理 SKU 的商品
4. 点击"SKU 管理"
5. 添加不同的颜色、尺码组合
6. 为每个 SKU 设置价格和图片

## 注意事项

1. **库存调整需要填写原因**
   - 所有库存变动都会被记录
   - 原因说明有助于后续审计和追溯

2. **减少库存不能超过可用库存**
   - 系统会自动检查，防止库存变为负数
   - 预留库存不能被直接调整

3. **多仓库管理**
   - 每个 SKU 可以在多个仓库有库存
   - 调整时需要选择具体的仓库

4. **库存预警阈值**
   - 可以为每个 SKU 设置预警阈值
   - 当库存低于阈值时会收到提醒

5. **权限要求**
   - 只有商家（merchant）和管理员（admin）可以调整库存
   - 普通用户无法访问库存管理功能

## 数据库表结构

### inventory 表
- `sku_id`: SKU ID
- `warehouse_id`: 仓库 ID
- `available`: 可用库存
- `reserved`: 预留库存
- `alert_threshold`: 预警阈值

### inventory_movements 表
- `sku_id`: SKU ID
- `warehouse_id`: 仓库 ID
- `quantity`: 变动数量（正数为增加，负数为减少）
- `reason`: 变动原因
- `operator_id`: 操作人 ID
- `created_at`: 操作时间

## 常见问题

**Q: 为什么我看不到库存管理功能？**
A: 需要具有商家或管理员权限。请联系管理员开通权限。

**Q: 如何设置库存预警阈值？**
A: 在 SKU 管理中可以为每个 SKU 设置预警阈值。

**Q: 预留库存是什么？**
A: 预留库存是已被订单占用但尚未发货的库存，会在订单发货或取消后自动释放。

**Q: 可以批量调整库存吗？**
A: 目前需要逐个 SKU 调整。批量调整功能正在开发中。

**Q: 库存变动记录可以删除吗？**
A: 不可以。所有库存变动记录都会永久保存，用于审计和追溯。
