# 备份与恢复演练（上线运维）

## 目标
- 确保数据库与存储可恢复，满足最小恢复点目标（RPO）与恢复时间目标（RTO）。

## 备份策略
1. 数据库自动备份（每日）
   - 使用 Supabase 管理面板启用每日备份。
   - 保留周期：至少 7–14 天。
2. 关键表导出（每周）
   - `orders`、`order_items`、`payments`、`refunds`、`inventory`、`skus`。
3. 对象存储（产品图片）
   - 开启版本控制/生命周期策略。
   - 每月做一次整桶快照。

## 恢复演练流程
1. 演练环境准备
   - 复制生产环境结构到 staging。
2. 恢复点选择
   - 选择最近一次备份或指定时间点（若支持 PITR）。
3. 恢复执行
   - 导入备份到 staging。
4. 验证清单
   - 核对订单数量、最近 24 小时订单、库存变动、支付状态。
5. 记录
   - 记录耗时、问题、修复措施。

## RPO / RTO 建议
- RPO ≤ 24h（每天备份）。
- RTO ≤ 2h（演练确保恢复速度）。

## 责任与审计
- 负责人：运维/后端负责人。
- 每季度至少一次演练并记录。
